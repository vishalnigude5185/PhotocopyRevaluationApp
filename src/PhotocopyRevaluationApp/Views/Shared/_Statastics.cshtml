@model IEnumerable<dynamic>
@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@
<div class="graph-container">
    <h3>Students Registrations By @ViewData["Title"] (Bar Chart)</h3>
    <canvas id="barChart" width="400" height="200"></canvas>
</div>
<hr />
<div class="graph-container">
    <h3>Students Registrations By @ViewData["Title"] (Pie Chart)</h3>
    <canvas id="pieChart" width="400" height="200"></canvas>
</div>

<p style="visibility: hidden">@ViewData["Title"]</p>

@section Scripts {
    <script>
        var paragraph = document.querySelector('p');
        if(paragraph.textContent === 'Date'){
        //Convert your Model's data into a usable format for Chart.js
        var labels = @Html.Raw(Json.Serialize(Model.Select(m => m.Column1)));
        var counts = @Html.Raw(Json.Serialize(Model.Select(m => m.Column2)));

        // Create the bar chart using Chart.js
        var ctxBar = document.getElementById('barChart').getContext('2d');
        var barChart = new Chart(ctxBar, {
            type: 'bar',
            data: {
                labels: labels,  // Dates
                datasets: [{
                    label: 'ApplicationUser Registrations',
                    data: counts,  // Counts
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Date' // X-axis label
                        }
                    },
                    y: {
                        beginAtZero: true, // Ensure y-axis starts at 0
                        title: {
                            display: true,
                            text: 'Count' // Y-axis label
                        }
                    }
                }
            }
        });

        // Create the pie chart using Chart.js
        var ctxPie = document.getElementById('pieChart').getContext('2d');
        var pieChart = new Chart(ctxPie, {
            type: 'pie',
            data: {
                labels: labels,  // Dates
                datasets: [{
                    label: 'ApplicationUser Registrations',
                    data: counts,  // Counts
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
        }
        });

        }
        else{
                    //Convert your Model's data into a usable format for Chart.js
        var labels = @Html.Raw(Json.Serialize(Model.Select(m => m.Column1)));
        var counts = @Html.Raw(Json.Serialize(Model.Select(m => m.Column2)));

        // Create the bar chart using Chart.js
        var ctxBar = document.getElementById('barChart').getContext('2d');
        var barChart = new Chart(ctxBar, {
            type: 'bar',
            data: {
                labels: labels,  // Dates
                datasets: [{
                    label: 'ApplicationUser Registrations',
                    data: counts,  // Counts
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    x: {
                        title: {
                            display: true,
                                   text: paragraph.textContent // X-axis label
                        }
                    },
                    y: {
                        beginAtZero: true, // Ensure y-axis starts at 0
                        title: {
                            display: true,
                            text: 'Count' // Y-axis label
                        }
                    }
                }
            }
        });

        // Create the pie chart using Chart.js
        var ctxPie = document.getElementById('pieChart').getContext('2d');
        var pieChart = new Chart(ctxPie, {
            type: 'pie',
            data: {
                labels: labels,  // Dates
                datasets: [{
                    label: 'ApplicationUser Registrations',
                    data: counts,  // Counts
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            }
        });

        }
    </script>
}